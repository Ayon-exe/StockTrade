<!-- index.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>StockTrade</title>
    <link rel="icon" type="image/x-icon" href="./images/favicon.ico">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
	
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    
    <!--<link rel="stylesheet" href="https://pyscript.net/releases/2022.12.1/pyscript.css" />
    <script defer src="https://pyscript.net/releases/2022.12.1/pyscript.js"> </script>-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body>    
    
    <!--<py-script src="./main.py"></py-script>-->
<div class="container" id="container">
        <div class="form-container sign-up">    
	<form>
                <h1>Register</h1>
                <div class="social-icons">
                    <a href="#" class="icon"><i class="fa-brands fa-google-plus-g"></i></a><a href="#" class="icon"><i class="fa-brands fa-facebook-f"></i></a><a href="#" class="icon"><i class="fa-brands fa-github"></i></a><a href="#" class="icon"><i class="fa-brands fa-linkedin-in"></i></a>
		</div>
                <span>or use your email for registeration</span>
                <input id='regusername' type="text" placeholder="Username">
                <input id='regemail' type="email" placeholder="Email">
                <input id='regpassword' type="password" placeholder="Password">
		<input type="submit" id='register' class="btn btn-primary" name="register_submit" value="Register"/>
            </form>
        </div>
        <div class="form-container sign-in">
            <form>
                <h1>Login</h1>
                <div class="social-icons">
                    <a href="#" class="icon"><i class="fa-brands fa-google-plus-g"></i></a><a href="#" class="icon"><i class="fa-brands fa-facebook-f"></i></a><a href="#" class="icon"><i class="fa-brands fa-github"></i></a><a href="#" class="icon"><i class="fa-brands fa-linkedin-in"></i></a>
		</div>
                <span>or use your email password</span>
                <input id='logemail' type="email" placeholder="Email">
                <input id='logpassword' type="password" placeholder="Password">
                <a href="#">Forget Your Password?</a>
		<input type="submit" id='login1' class="btn btn-primary" name="login_submit" value="Login"/>
</form>
        </div>
        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-left">
                    <h1>Welcome Back!</h1>
                    <p>Enter your personal details to use all of the site features</p>
                    <button class="hidden" id="login">Sign In</button>
                </div>
                <div class="toggle-panel toggle-right">
                    <h1>Hello, Friend!</h1>
                    <p>Register with your personal details to use all of the site features</p>
                    <button class="hidden" id="signup">Sign Up</button>
                </div>
            </div>
        </div>
    </div>

<script>
const container = document.getElementById('container');
const signupBtn = document.getElementById('signup');
const loginBtn = document.getElementById('login');
signupBtn.addEventListener('click', () => 
{
    container.classList.add("active");
});
loginBtn.addEventListener('click', () => 
{
    container.classList.remove("active");
});
</script>
	
<!--<div id="register" class="wrapper">
	<h1 align="center">Register</h1>
  <div class="row g-0">
    <div class="col-md-4">
	<span class="material-icons md-18" alt="Register">how_to_reg</span>
    </div>
    <div class="col-md-8">
      <div class="card-body">
	<label>Email</label>
	<input id= "email" placeholder="Email"/>
	<br>
        <label>UserName</label>
	<input id= "username" placeholder="Username"/>
	<br>
	<label>Password</label>
	<input id= "password" type="password" placeholder="Password"/>
	<be>    
	<input type="submit" id='signup' class="btn btn-primary" name="signup_submit" value="signup"/>
      </div>
    </div>
  </div>
</div>

<div id="Login" class="wrapper">
	<h1 align="center">Login</h1>
  <div class="row g-0">
    <div class="col-md-4">
	<span class="material-icons md-18" alt="Login">login</span>
    </div>
    <div class="col-md-8">
      <div class="card-body">
	<label>Email</label>
	<input id= "email" placeholder="Email"/>
	<br>
	<label>Password</label>
	<input id= "password" type="password" placeholder="Password"/>
	<br>    
	<!--<input type="submit" id='login' class="btn btn-primary" name="login_submit" value="Login"/>
      </div>
    </div>
  </div>
</div>
<br>
<input type="submit" id='logout' class="btn btn-primary" name="logout_submit" value="Logout"/>

<nav>
    <a href="emoji.html">Emoji</a>
    <a href="images/gallery.html">Gallery</a>-->
<a href="homepage.html" class="btn btn-primary">Next page</a></div>
<script type="module">
  // Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-analytics.js";
	
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyD4wlA68qZp41M_CfUf1j93oYn41CoN5eo",
    authDomain: "stocktrade-173c8.firebaseapp.com",
    projectId: "stocktrade-173c8",
    storageBucket: "stocktrade-173c8.appspot.com",
    messagingSenderId: "58004670302",
    appId: "1:58004670302:web:e942b65ba9ccdaec9d71cf",
    measurementId: "G-BJTP6ZD69S"
  };

  // Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const database = getDatabase(app);
const auth = getAuth();

register.addEventListener('click',(e) => {
	var email = document.getElementById('regemail').value;
	var username=document.getElementById('regusername').value;
	var password=document.getElementById('regpassword').value;
	createUserWithEmailAndPassword(auth, email, password)
		.then((userCredential) => {
		//signed in
		const user = userCredential.user;
			
		set(ref(database, 'users/' + user.uid),{
			username: username,
			email: email
		})
		
		alert('user created!');
	})
	.catch((error)=> {
		const errorCode=error.code;
		const errorMessage=error.message;
		alert(errorMessage);
	})
});

login1.addEventListener('click',(e) => {
	var email = document.getElementById('logemail').value;
	var password=document.getElementById('logpassword').value;
	signInWithEmailAndPassword(auth, email, password)
  	.then((userCredential) => {
    	// Signed in 
    	const user = userCredential.user;
	const dt= new Date();
		update(ref(database, 'users/' + user.uid),{
			LastLoginDate: dt
		})
		
		alert('user logged in!');
  	})
  	.catch((error) => {
    	const errorCode = error.code;
    	const errorMessage = error.message;
	alert(errorMessage);
  	});
});
	
const user = auth.currentUser;
onAuthStateChanged(auth, (user) => {
  if (user) {
    // User is signed in, see docs for a list of available properties
    // https://firebase.google.com/docs/reference/js/auth.user
    const uid = user.uid;
    // ...
  } else {
    // User is signed out
    // ...
  }
});

logout.addEventListener('click',(e) => {
	signOut(auth).then(() => {
  	// Sign-out successful.
	alert('user Signed out');
	})
	.catch((error) => {
    	const errorCode = error.code;
    	const errorMessage = error.message;
	alert(errorMessage);
  	});
});
</script>
<script src="./myscript.js"></script>
</body>
</html>
